<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<p id="p1"></p>
<p id="p2"></p>
<p id="p3"></p>
<button id="btn">test</button>
<script src="lodash.js"></script>
<script src="//cdn.rawgit.com/dtao/lazy.js/7a9b0210d97168ff48c5d2b4ce4d12194ba7fbec/lazy.js"></script>
<script>
    var arr = _.range(1000000);

    function isEven(x) { return x % 2 == 0; }
    function inc(x) { return x+1; }
    function toTrue() { return true; }
    function identity(x) { return x; }

    var arr = _.range(100000);
    var limit = 10000;

    function unit() {
//        var r = _.lazy(arr).map(identity).filter(toTrue).map(identity).take(limit).value();
        var r = _.lazy(arr).map(identity).filter(toTrue).map(identity).value();
    }

    function unit2() {
//        var r = Lazy(arr).map(identity).filter(toTrue).map(identity).take(limit).value();
        var r = Lazy(arr).map(identity).filter(toTrue).map(identity).value();
    }

    function test(func) {
        // _.lazy(arr).reverse().filter(isEven).take(1000000).map(inc).value();
//        _.lazy(arr).value();
        var inc = 100;
        while(inc--) func();
    }
    var start = +new Date;

    test(unit);

    var stop = +new Date;

    var aTime = ((stop-start)/100);
    p1.innerHTML += ('<br>time = ' + aTime);

    var start = +new Date;

    test(unit2);

    var stop = +new Date;


    var bTime = ((stop - start) / 100);
    p2.innerHTML += ('<br>time = ' + bTime);
    p3.innerHTML += ('<br>'+ (((aTime/bTime)-1)*100+"").split(".")[0] + "%");

    btn.addEventListener("click", function handler(e) {
        var start = +new Date;
        test(unit);
        var time = (+new Date) - start;
        p1.innerHTML = "time = " + (time/100);
    });

</script>
</body>
</html>